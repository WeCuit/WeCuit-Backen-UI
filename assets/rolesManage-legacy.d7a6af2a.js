!function(){function e(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function n(n){for(var r=1;r<arguments.length;r++){var l=null!=arguments[r]?arguments[r]:{};r%2?e(Object(l),!0).forEach((function(e){t(n,e,l[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(l)):e(Object(l)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(l,e))}))}return n}function t(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n,t,r,l,o,a){try{var i=e[o](a),u=i.value}catch(c){return void t(c)}i.done?n(u):Promise.resolve(u).then(r,l)}var l=document.createElement("style");l.innerHTML=".btns[data-v-2112513b]{text-align:right}.el-transfer[data-v-2112513b]{display:inline-block;text-align:left}.transfer[data-v-2112513b]{text-align:center}.card-header[data-v-2112513b]{text-align:left}\n",document.head.appendChild(l),System.register(["./index-legacy.3c2ce67b.js","./vendor-legacy.81140759.js"],(function(e){"use strict";var t,l,o,a,i,u,c,s,f,d,m,p,g,b,v,h,y,_,k,w,C,O,z,x,E;return{setters:[function(e){t=e.r,l=e.u},function(e){o=e.d,a=e.J,i=e.i,u=e.y,c=e.b,s=e.z,f=e.A,d=e.k,m=e.aW,p=e.G,g=e.e,b=e.c,v=e.s,h=e.q,y=e.g,_=e.v,k=e.p,w=e.f,C=e.I,O=e.r,z=e.E,x=e.m,E=e.K}],execute:function(){var R=o({name:"RolesEdit",props:{currentRole:{type:Object,default:function(){return{name:"",state:1}}}},emits:["success"],setup:function(e,o){var d=o.emit,m=a(e,"currentRole"),p=l(),g=i((function(){return p.getters["settingsModule/getLangState"]})),b=u({url:"/role/allow",purl:"/role/permissions",loading:!1,form:{key:"",label:""},menu:{loading:!1,url:"/menu/list",data:[],form:[],original:[]}}),v=i((function(){return m.value.role})),h=function(){var e,n=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=v.value.id,t.get("/auth/roles/menus",{params:{role_id:n}})).then((function(e){if(null!=e&&e.data){var n=e.data.authedRoutes;b.menu.form=n,b.menu.original=JSON.parse(JSON.stringify(n))}}));case 1:case"end":return e.stop()}var n}),e)})),function(){var n=this,t=arguments;return new Promise((function(l,o){var a=e.apply(n,t);function i(e){r(a,l,o,i,u,"next",e)}function u(e){r(a,l,o,i,u,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}(),y=function(){t.get("/auth/menus").then((function(e){e.data.forEach((function(e){b.menu.data.push({key:null==e?void 0:e.id,label:null==e?void 0:e.name})}))}))};return c((function(){console.log("onMounted"),y()})),s((function(){h()})),n(n({},f(b)),{},{lang:g,role:v,fetchMenuData:y,saveData:function(){console.log("original is ",b.menu.original),console.log("new is ",b.menu.form);var e,n=[];b.menu.original.forEach((function(e){b.menu.form.includes(e)||n.push({roleId:v.value.id,menuId:e,type:2})})),b.menu.form.forEach((function(e){b.menu.original.includes(e)||n.push({roleId:v.value.id,menuId:e,type:1})})),(e=n,t.patch("/auth/roles/menus",e)).then((function(e){console.log(e),d("success")}))}})}}),S=function(e){return k("data-v-2112513b"),e=e(),w(),e},j={class:"wrapper"},N={class:"card-header"},V=S((function(){return y("br",null,null,-1)})),P=S((function(){return y("i",{class:"fa fa-check"},null,-1)})),D=C(" 确认修改 ");R.render=function(e,n,t,r,l,o){var a=d("el-form-item"),i=d("el-form"),u=d("el-transfer"),c=d("el-card"),s=d("el-button"),f=d("el-row"),k=m("loading");return p((g(),b("div",j,[v(c,{class:"transfer"},{header:h((function(){return[y("span",null,[y("div",N,[v(i,{"label-position":"left",inline:"",class:"info-table"},{default:h((function(){return[v(a,{label:"名称"},{default:h((function(){return[y("span",null,_(e.role.name),1)]})),_:1})]})),_:1})])])]})),default:h((function(){return[p(v(u,{modelValue:e.menu.form,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.menu.form=n}),data:e.menu.data,titles:["菜单","已授权"]},null,8,["modelValue","data"]),[[k,e.menu.loading]])]})),_:1}),V,v(f,{class:"btns"},{default:h((function(){return[v(s,{size:"mini",type:"primary",disabled:0==e.role.state,onClick:e.saveData},{default:h((function(){return[P,D]})),_:1},8,["disabled","onClick"])]})),_:1})],512)),[[k,e.loading]])},R.__scopeId="data-v-2112513b";var M=o({name:"RoleNew",emits:["success"],setup:function(e,t){var r=t.emit,l=O(),o=u({form:{roleName:"",remark:""},loading:!1});return n({submitForm:function(){l.value.validate((function(e){return e?(r("success",n({},o.form)),o.form={roleName:"",remark:""},!0):(console.log("error submit!!"),!1)}))},rules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}]},formRef:l,url:"/role/add"},f(o))}}),I={class:"new"},T=y("i",{class:"fa fa-plus"},null,-1),U=C(" 新增 ");M.render=function(e,n,t,r,l,o){var a=d("el-input"),i=d("el-form-item"),u=d("el-button"),c=d("el-row"),s=d("el-form"),f=m("loading");return p((g(),b("div",I,[v(s,{ref:"formRef",model:e.form,rules:e.rules,"label-position":"right","label-width":"100px"},{default:h((function(){return[v(i,{label:"角色名称",prop:"roleName"},{default:h((function(){return[v(a,{modelValue:e.form.roleName,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.form.roleName=n}),placeholder:"请输入角色名称"},null,8,["modelValue"])]})),_:1}),v(i,{label:"备注"},{default:h((function(){return[v(a,{modelValue:e.form.remark,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.form.remark=n}),placeholder:"请输入备注"},null,8,["modelValue"])]})),_:1}),v(c,{class:"btn-container"},{default:h((function(){return[v(u,{size:"mini",type:"primary",onClick:n[2]||(n[2]=function(n){return e.submitForm()})},{default:h((function(){return[T,U]})),_:1})]})),_:1})]})),_:1},8,["model","rules"])],512)),[[f,e.loading]])};var B=function(e){return console.log("删除的ID:",e),z.ElMessageBox.confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return(n=e,t.delete("/auth/roles/".concat(n))).then((function(e){console.log(e),z.ElMessage({type:"success",message:"删除成功"})}));var n})).catch((function(){z.ElMessage({type:"info",message:"已取消删除"})}))},J=e("default",o({name:"RoleManage",components:{RoleEdit:R,RoleNew:M},setup:function(){var e=u({url:{c:"/role/add",r:"/role/list",u:"/role/update",d:"/role/delete"},param:{limit:10,page:1},data:[{id:1,name:"超级管理员",remark:"拥有删除和创建等操作的权限",state:0},{id:2,name:"管理员",remark:"测试",state:0}],loading:!1,is_search:!1,add_visible:!1,edit_visible:!1,detail_visible:!1,posted:{role:{roleName:"",state:1}}}),r=i((function(){return e.data.length})),l=function(){console.log("获取角色列表"),t.get("/auth/roles").then((function(n){console.log(n),e.data=n.data}))};l();return n(n({},f(e)),{},{total:r,onCurrentChange:function(){l()},onSizeChange:function(n){e.param.limit=n,l()},onCreate:function(){e.add_visible=!0},onCreateNewRole:function(n){e.add_visible=!1;var r,o={name:n.roleName,remark:n.remark,state:1};(r=o,t.post("/auth/roles",r)).then((function(e){console.log(e),l()}))},onEditSuccess:function(){e.edit_visible=!1,l()},onRefresh:function(){e.is_search=!1,l()},onEdit:function(n,t){console.log("row",t),e.posted.role=t,e.edit_visible=!0},onDelete:function(e,n){console.log(e,n),B(n.id).then((function(){l()}))}})}})),q=C("新增"),F=C("刷新"),L=y("br",null,null,-1),$=y("i",{class:"ic ic-lock"},null,-1),A=C(" 锁定 "),G=C("正常"),H=C("未知"),K={class:"pagination"};J.render=function(e,n,t,r,l,o){var a=d("el-alert"),i=d("el-button"),u=d("el-col"),c=d("el-row"),s=d("el-table-column"),f=d("el-tag"),_=d("el-tooltip"),k=d("el-table"),w=d("el-pagination"),C=d("el-card"),O=d("role-edit"),z=d("el-dialog"),R=d("role-new"),S=m("loading");return g(),b("div",null,[v(a,{title:"Tips:点击【新增】按钮进行新增角色；点击【编辑】按钮，进行不同角色的菜单授权操作！",type:"warning"}),v(a,{title:"Tips:权限控制体验：【管理员账号为：admin@outlook.com】、【超级管理员账号为：super@outlook.com】",type:"info"}),v(C,{class:"card-ctrl"},{default:h((function(){return[v(c,null,{default:h((function(){return[v(u,{span:8,style:{"text-align":"left"}},{default:h((function(){return[v(i,{type:"primary",icon:"el-icon-plus",size:"small",onClick:e.onCreate},{default:h((function(){return[q]})),_:1},8,["onClick"]),v(i,{type:"success",icon:"el-icon-refresh",size:"small",onClick:e.onRefresh},{default:h((function(){return[F]})),_:1},8,["onClick"])]})),_:1})]})),_:1}),L,p(v(k,{data:e.data,stripe:"",class:"table"},{default:h((function(){return[v(s,{prop:"name",label:"角色名称",align:"center"}),v(s,{prop:"state",label:"角色状态",align:"center"},{default:h((function(e){return[0==e.row.state?(g(),x(f,{key:0,size:"mini",type:"info"},{default:h((function(){return[$,A]})),_:1})):1==e.row.state?(g(),x(f,{key:1,size:"mini",type:"success"},{default:h((function(){return[G]})),_:1})):(g(),x(f,{key:2,size:"mini",type:"danger"},{default:h((function(){return[H]})),_:1}))]})),_:1}),v(s,{prop:"remark",label:"备注",align:"center"}),v(s,{label:"操作",align:"center"},{default:h((function(n){return[v(_,{class:"item",effect:"dark",content:"菜单授权",placement:"bottom"},{default:h((function(){return[v(i,{circle:"",plain:"",type:"primary",icon:"el-icon-edit",size:"small",onClick:function(t){return e.onEdit(n.$index,n.row)}},null,8,["onClick"])]})),_:2},1024),0!=n.row.state?(g(),x(_,{key:0,class:"item",effect:"dark",content:"删除",placement:"bottom"},{default:h((function(){return[v(i,{circle:"",plain:"",type:"danger",icon:"el-icon-minus",size:"small",onClick:function(t){return e.onDelete(n.$index,n.row)}},null,8,["onClick"])]})),_:2},1024)):E("",!0)]})),_:1})]})),_:1},8,["data"]),[[S,e.loading]]),y("div",K,[v(w,{"current-page":e.param.page,"page-size":e.param.limit,layout:"sizes,prev,pager,next,total","page-sizes":[5,10,20],total:e.total,background:"",onCurrentChange:e.onCurrentChange,onSizeChange:e.onSizeChange},null,8,["current-page","page-size","total","onCurrentChange","onSizeChange"])])]})),_:1}),v(z,{modelValue:e.edit_visible,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.edit_visible=n}),center:"",title:e.posted.role.roleName,width:"70%"},{default:h((function(){return[v(O,{"current-role":e.posted,onSuccess:e.onEditSuccess},null,8,["current-role","onSuccess"])]})),_:1},8,["modelValue","title"]),v(z,{modelValue:e.add_visible,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.add_visible=n}),title:"新增角色"},{default:h((function(){return[v(R,{onSuccess:e.onCreateNewRole},null,8,["onSuccess"])]})),_:1},8,["modelValue"])])}}}}))}();
